!function(e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():window.Popup=e()}((function(){let e=function(e,t){let o=this,n=function(e,t){for(let o in e)void 0===t[o]?t[o]=e[o]:"object"==typeof t[o]&&n(e[o],t[o])};return o.options=t||{},o.selector=e,o.defaults={popupClass:"active",bodyClass:"no-scroll",fakeScrollbarClass:"active",mainPopupClass:"Popup",clickToClose:!0,escToClose:!0,allowPageScroll:!1,transitions:!0,animations:!1,fakeScrollbar:"#fake-scrollbar"},n(o.defaults,o.options),o.init(),o.$popup};return e.prototype.dispatchEvent=function(e,t){if("function"==typeof window.CustomEvent){let o=new CustomEvent(t);e.dispatchEvent(o)}},e.prototype.refresh=function(){let e=this.ctx||this;e.destroy(),e.init(e.selector)},e.prototype.destroy=function(){let e=this.ctx||this,t=e.$popup,o=e.$openButtons,n=e.$closeButtons;if(t){if(t.classList.remove(e.options.mainPopupClass),t.removeEventListener(e.endEvent,e.transitionEnd),t.removeEventListener("click",e.clickToClose),document.removeEventListener("keyup",e.closePopupHandler),o)for(let t=0;t<o.length;t++)o[t]&&o[t].removeEventListener("click",e.openPopupHandler);if(n)for(let t=0;t<n.length;t++)n[t]&&n[t].removeEventListener("click",e.closePopupHandler)}},e.prototype.init=function(){let e=this,t=e.options,o=function(e,t,o){return"string"==typeof t?o?document.querySelectorAll(t):document.querySelector(t):t};e.$popup=o(e.$popup,e.selector),e.$openButtons=o(e.$openButtons,t.openButtons,!0),e.$closeButtons=o(e.$closeButtons,t.closeButtons,!0),e.$fakeScrollbar=o(e.$fakeScrollbar,t.fakeScrollbar),e.$popup.ctx=e,e.openPopupHandler={handleEvent:e.openPopup,ctx:e},e.closePopupHandler={handleEvent:e.closePopup,ctx:e},e.$popup.openPopup=e.openPopup,e.$popup.closePopup=e.closePopup,e.$popup.refreshPopup=e.refresh,e.$popup.destroyPopup=e.destroy,e.endEvent=t.transitions?"transitionend":!!t.animations&&"animationend",e.$popup.classList.add(t.mainPopupClass),e.initEvents(),"none"===e.$popup.style.display&&(e.$popup.style.display="",e.$popup.offsetWidth),e.dispatchEvent(e.$popup,"popupinit")},e.prototype.initEvents=function(){let e=this,t=e.$openButtons,o=e.$closeButtons;if(o)for(let t=0;t<o.length;t++)o[t]&&o[t].addEventListener("click",e.closePopupHandler);if(t)for(let o=0;o<t.length;o++)t[o]&&t[o].addEventListener("click",e.openPopupHandler);e.options.clickToClose&&e.$popup.addEventListener("click",e.clickToClose),e.options.escToClose&&document.addEventListener("keyup",e.closePopupHandler)},e.prototype.transitionEnd=function(){let e=this.ctx||this,t=e.$popup;"open"===e.action?e.dispatchEvent(t,"popupopen"):(e.dispatchEvent(t,"popupclose"),e.allowPageScroll()),t.removeEventListener(e.endEvent,e.transitionEnd)},e.prototype.clickToClose=function(){event.target===this&&this.closePopup()},e.prototype.openPopup=function(){let e=this.ctx||this,t=e.options,o=e.$fakeScrollbar,n=document.body,p=e.$popup;p.classList.contains(t.popupClass)||(event&&"click"===event.type&&(e.$caller=p.caller=event.target),p.hasAttribute("style")&&(p.removeAttribute("style"),p.offsetWidth),e.action="open",e.dispatchEvent(p,"popupbeforeopen"),e.endEvent?p.addEventListener(e.endEvent,e.transitionEnd):e.dispatchEvent(p,"popupopen"),p.classList.add(t.popupClass),o&&(o.classList.add(t.fakeScrollbarClass),n.classList.add(t.bodyClass),n.style.paddingRight=o.offsetWidth-o.clientWidth+"px"))},e.prototype.closePopup=function(){if(event&&"keyup"===event.type&&27!==event.keyCode)return;let e=this.ctx||this,t=e.options,o=e.$popup;o.classList.contains(t.popupClass)&&(e.action="close",e.dispatchEvent(o,"popupbeforeclose"),e.endEvent?o.addEventListener(e.endEvent,e.transitionEnd):(e.dispatchEvent(o,"popupclose"),e.allowpagescroll()),o.classList.remove(t.popupClass))},e.prototype.allowPageScroll=function(){let e=this.ctx||this,t=e.options,o=e.$fakeScrollbar,n=document.body,p=Array.prototype.slice.call(document.querySelectorAll(".Popup"));o&&p.every((function(e){return!e.classList.contains(t.popupClass)}))&&(n.style.paddingRight="",o.classList.remove(t.fakeScrollbarClass),n.classList.remove(t.bodyClass))},e}));